<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RENCE CREATE | Shop</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@400;700;900&family=Fraunces:ital,opsz,wght@0,9..144,700;1,9..144,400&display=swap" rel="stylesheet">

    <style>
        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
           ROOT VARIABLES
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        :root {
            --bg:            #f4f4f4;
            --black:         #000000;
            --accent:        #00ff66;
            --white:         #ffffff;
            --grey:          #e0e0e0;
            --text-muted:    #555555;
            --border:        3px solid var(--black);
            --shadow-sm:     6px 6px 0px var(--black);
            --shadow-lg:     12px 12px 0px var(--black);
            --shadow-accent: 8px 8px 0px var(--accent);
            --ease:          cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --transition:    all 0.25s var(--ease);
            --primary:       var(--black);
            --text:          var(--black);
            --text-light:    var(--text-muted);
            --danger:        #e00000;
            --success:       var(--accent);
        }

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
           RESET & BASE
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Unbounded', sans-serif;
            background: var(--bg);
            color: var(--black);
            overflow-x: hidden;
            line-height: 1.5;
            padding-top: 80px;
            padding-bottom: 100px;
        }

        .hidden { display: none !important; }

        h1, h2, h3, .serif {
            font-family: 'Fraunces', serif;
            font-style: italic;
            font-weight: 400;
        }

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
           FIXED GLASSMORPHISM HEADER
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        header {
            position: fixed;
            top: 16px;
            left: 16px;
            right: 16px;
            z-index: 500;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 28px;
            background: rgba(255,255,255,0.72);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            border: var(--border);
            box-shadow: var(--shadow-sm);
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
            will-change: transform, opacity;
        }

        header.headroom--hidden {
            transform: translateY(calc(-100% - 32px));
            opacity: 0;
            pointer-events: none;
        }

        .logo {
            font-family: 'Unbounded', sans-serif;
            font-weight: 900;
            font-size: 1.3rem;
            letter-spacing: -1.5px;
            color: var(--black);
            text-decoration: none;
        }

        .header-right { display: flex; align-items: center; gap: 20px; }

        .cart-btn {
            font-family: 'Unbounded', sans-serif;
            font-weight: 900;
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: var(--black);
            color: var(--white);
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
            text-decoration: none;
            display: inline-block;
        }

        .cart-btn:hover {
            background: var(--accent);
            color: var(--black);
            transform: translateY(-3px);
            box-shadow: 4px 4px 0px var(--black);
        }

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
           INPUTS & BUTTONS (global)
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        input, textarea, select {
            width: 100%;
            padding: 11px 14px;
            border: 2px solid var(--black);
            border-radius: 0;
            background: var(--white);
            font-family: 'Unbounded', sans-serif;
            font-size: 0.7rem;
            color: var(--black);
            margin-bottom: 10px;
            transition: box-shadow 0.2s;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            box-shadow: 4px 4px 0px var(--accent);
        }

        button {
            font-family: 'Unbounded', sans-serif;
            font-weight: 900;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: var(--black);
            color: var(--white);
            border: none;
            padding: 12px 22px;
            cursor: pointer;
            transition: var(--transition);
        }

        button:hover {
            background: var(--accent);
            color: var(--black);
            transform: translate(-2px, -2px);
            box-shadow: 4px 4px 0px var(--black);
        }

        button.btn-ghost {
            background: var(--grey);
            color: #444;
        }

        button.btn-ghost:hover {
            background: var(--grey);
            color: var(--black);
            box-shadow: 3px 3px 0px var(--black);
        }

        button.btn-danger  { background: var(--danger); color: var(--white); }
        button.btn-success { background: var(--accent);  color: var(--black); border: 2px solid var(--black); }

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
           WELCOME BANNER
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        #welcome-banner {
            text-align: center;
            padding: 40px 24px 0;
            max-width: 1300px;
            margin: 0 auto;
        }

        #welcome-banner .greet-line {
            font-family: 'Unbounded', sans-serif;
            font-size: 0.58rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 3px;
            color: var(--text-muted);
            margin-bottom: 6px;
        }

        #welcome-banner .greet-name {
            font-family: 'Fraunces', serif;
            font-style: italic;
            font-size: clamp(2rem, 6vw, 3.2rem);
            font-weight: 700;
            line-height: 1.05;
            color: var(--black);
        }

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
           CATEGORY / FOLDER NAV
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .category-section {
            max-width: 1300px;
            margin: 0 auto;
            padding: 56px 24px 24px;
            text-align: center;
        }

        .folder-nav {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 32px;
            margin-bottom: 28px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }
        .folder-nav::-webkit-scrollbar { display: none; }

        .folder-link {
            font-family: 'Unbounded', sans-serif;
            font-weight: 900;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            position: relative;
            padding-bottom: 6px;
            transition: var(--transition);
            user-select: none;
        }

        .folder-link::after {
            content: '';
            position: absolute;
            bottom: 0; left: 0;
            width: 0; height: 4px;
            background: var(--accent);
            transition: width 0.3s var(--ease);
        }

        .folder-link:hover::after,
        .folder-link.active::after { width: 100%; }

        .sub-nav {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            min-height: 36px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }
        .sub-nav::-webkit-scrollbar { display: none; }

        .sub-pill {
            font-family: 'Unbounded', sans-serif;
            font-weight: 900;
            font-size: 0.6rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 7px 20px;
            border: 2px solid var(--black);
            border-radius: 50px;
            background: transparent;
            color: var(--black);
            cursor: pointer;
            transition: var(--transition);
        }

        .sub-pill:hover,
        .sub-pill.active {
            background: var(--black);
            color: var(--white);
            transform: scale(1.06);
            box-shadow: none;
        }

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
           ART GRID
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .shop-container-new {
            max-width: 1300px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        .art-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 36px;
        }

        .art-card {
            border: var(--border);
            background: var(--white);
            padding: 14px;
            cursor: pointer;
            transition: transform 0.25s var(--ease), box-shadow 0.25s var(--ease);
        }

        .art-card:hover {
            transform: translate(-8px, -8px);
            box-shadow: var(--shadow-lg);
        }

        .img-container {
            width: 100%;
            aspect-ratio: 1 / 1;
            border: 2px solid var(--black);
            background: #e4e4e4;
            overflow: hidden;
            position: relative;
        }

        .img-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .art-card:hover .img-container img { transform: scale(1.08); }

        .img-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
            color: var(--text-muted);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .card-details {
            margin-top: 14px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            gap: 10px;
        }

        .card-details .card-info small {
            display: block;
            font-size: 0.55rem;
            font-weight: 700;
            text-transform: uppercase;
            color: #888;
            margin-bottom: 4px;
            letter-spacing: 0.5px;
        }

        .card-details .card-info h4 {
            font-family: 'Unbounded', sans-serif;
            font-weight: 900;
            font-size: 0.85rem;
            text-transform: uppercase;
            line-height: 1.2;
        }

        .price-tag {
            font-family: 'Unbounded', sans-serif;
            font-weight: 900;
            font-size: 1rem;
            background: var(--accent);
            color: var(--black);
            padding: 2px 8px;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .empty-state {
            grid-column: 1 / -1;
            text-align: center;
            padding: 80px 20px;
        }

        .empty-state h2 {
            font-family: 'Fraunces', serif;
            font-style: italic;
            font-size: 2.5rem;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .empty-state p {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
           STICKY CART BAR
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .cart-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 400;
            background: var(--white);
            border-top: var(--border);
            box-shadow: 0 -4px 0px var(--black);
            padding: 14px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }

        .cart-bar-info {
            display: flex;
            gap: 24px;
            font-size: 0.65rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .cart-bar-info span b {
            background: var(--accent);
            padding: 1px 7px;
            color: var(--black);
            font-weight: 900;
        }

        .cart-bar button {
            padding: 14px 32px;
            font-size: 0.75rem;
            flex-shrink: 0;
        }

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
           MODAL OVERLAY
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.87);
            backdrop-filter: blur(6px);
            -webkit-backdrop-filter: blur(6px);
            display: flex;
            align-items: flex-start;
            justify-content: center;
            z-index: 1000;
            padding: 24px 16px 48px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .modal-card {
            background: var(--white);
            border: var(--border);
            width: 100%;
            max-width: 460px;
            padding: 28px 24px;
            box-shadow: 8px 8px 0px var(--accent);
            position: relative;
            margin: auto;
            flex-shrink: 0;
        }

        .checkout-card {
            background: var(--white);
            border: var(--border);
            width: 100%;
            max-width: 460px;
            padding: 28px 24px;
            box-shadow: 8px 8px 0px var(--accent);
            position: relative;
            margin: auto;
            flex-shrink: 0;
        }

        /* Invoice / order sheet */
        .invoice-paper {
            border: 2px dashed var(--black);
            padding: 20px;
            margin: 20px 0;
            background: #fafafa;
        }

        .invoice-paper .invoice-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            font-size: 0.78rem;
            margin-bottom: 10px;
        }

        .invoice-paper .invoice-row .item-name { font-weight: 900; text-transform: uppercase; }
        .invoice-paper .invoice-row .item-qty  { font-size: 0.65rem; color: var(--text-muted); }
        .invoice-paper .invoice-row .item-price { font-weight: 900; }

        .invoice-divider { border: none; border-top: 2px dashed var(--black); margin: 14px 0; }

        .invoice-total {
            display: flex;
            justify-content: space-between;
            font-weight: 900;
            font-size: 1rem;
        }

        .invoice-total .total-amount { background: var(--accent); padding: 2px 10px; }

        .btn-action {
            display: block;
            width: 100%;
            padding: 16px;
            font-family: 'Unbounded', sans-serif;
            font-weight: 900;
            font-size: 0.75rem;
            text-transform: uppercase;
            background: var(--black);
            color: var(--white);
            border: none;
            cursor: pointer;
            margin-top: 10px;
            transition: var(--transition);
        }

        .btn-action:hover {
            transform: translate(-3px, -3px);
            box-shadow: 5px 5px 0px var(--accent);
            background: var(--black);
            color: var(--white);
        }

        .btn-download {
            background: var(--accent);
            color: var(--black);
            border: 2px solid var(--black);
        }

        .btn-download:hover {
            background: var(--accent);
            color: var(--black);
            box-shadow: 5px 5px 0px var(--black);
        }

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
           USER PRODUCT VIEW MODAL
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .slider-container {
            position: relative;
            width: 100%;
            aspect-ratio: 16 / 9;
            border: 2px solid var(--black);
            background: var(--bg);
            overflow: hidden;
            margin-bottom: 20px;
        }

        .slider-wrapper { display: flex; height: 100%; transition: transform 0.35s ease; }
        .slider-wrapper img { width: 100%; height: 100%; object-fit: cover; flex-shrink: 0; }

        .slider-btn-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.9);
            border: 2px solid var(--black);
            width: 36px; height: 36px;
            font-size: 0.9rem;
            font-weight: 900;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .slider-btn-nav:hover {
            background: var(--accent);
            transform: translateY(-50%) translate(-2px, -2px);
            box-shadow: 3px 3px 0px var(--black);
        }

        .modal-price-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--bg);
            border: 2px solid var(--black);
            padding: 14px 18px;
            margin-top: 20px;
        }

        .modal-price {
            font-family: 'Unbounded', sans-serif;
            font-weight: 900;
            font-size: 1.3rem;
            background: var(--accent);
            padding: 2px 10px;
        }

        .qty-controls { display: flex; align-items: center; gap: 14px; }

        .qty-btn {
            width: 36px; height: 36px;
            background: var(--accent);
            color: var(--black);
            border: 2px solid var(--black);
            font-size: 1.1rem;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            padding: 0;
            transition: var(--transition);
        }

        .qty-btn:hover {
            background: var(--black);
            color: var(--accent);
            transform: translate(-2px, -2px);
            box-shadow: 3px 3px 0px var(--accent);
        }

        #view-qty-display {
            font-weight: 900;
            font-size: 1.1rem;
            min-width: 24px;
            text-align: center;
        }

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
           TOAST NOTIFICATION
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        #custom-alert {
            position: fixed;
            bottom: 88px;
            right: 24px;
            background: var(--black);
            color: var(--white);
            padding: 14px 22px;
            border: 2px solid var(--accent);
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transform: translateY(calc(100% + 140px));
            opacity: 0;
            pointer-events: none;
            transition: transform 0.45s var(--ease), opacity 0.45s ease;
            z-index: 9999;
            box-shadow: 5px 5px 0px var(--accent);
            max-width: 320px;
        }

        #custom-alert.show {
            transform: translateY(0);
            opacity: 1;
            pointer-events: auto;
        }

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
           FOOTER
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        footer {
            background: var(--black);
            color: var(--white);
            padding: 40px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 0;
            /* No gap ‚Äî sits directly above the fixed 72px cart bar */
        }

        .est-tag {
            font-family: 'Unbounded', sans-serif;
            font-weight: 900;
            font-size: clamp(1rem, 4vw, 1.5rem);
            line-height: 1.3;
        }

        .footer-copy {
            text-align: right;
            font-size: 0.6rem;
            opacity: 0.5;
            line-height: 2;
            font-weight: 400;
            letter-spacing: 1px;
        }

        /* Modal actions */
        .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-actions button { flex: 1; }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
           MOBILE ‚Äî main-shop.html
           All rules inside @media (max-width: 767px) ‚Äî desktop untouched
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

        /* ‚îÄ‚îÄ Tab bar (hidden on desktop, shown on mobile via media query) ‚îÄ‚îÄ */
        #mobile-tab-bar { display: none; }

        @media (max-width: 767px) {

            /* CSS custom props for tab bar sizing */
            :root {
                --tab-h:    64px;
                --tab-safe: max(env(safe-area-inset-bottom, 0px), 8px);
                --tab-tot:  calc(var(--tab-h) + var(--tab-safe));
                /* Cart bar stacks above tab bar */
                --cart-h:   96px;
            }

            /* Momentum scrolling ‚Äî the #1 "feels native" trick */
            html, body { -webkit-overflow-scrolling: touch; }

            *, *::before, *::after { box-sizing: border-box; }

            /* Body: no top padding (header hidden)
               Bottom padding = tab bar only ‚Äî footer margin handles the rest */
            body {
                padding-top: 0 !important;
                padding-bottom: 0 !important;
            }

            /* Kill long-press callouts on interactive elements */
            a, button, [role="button"], .folder-link, .sub-pill, .art-card {
                -webkit-touch-callout: none;
                -webkit-tap-highlight-color: rgba(0,255,102,0.18);
            }

            /* ‚îÄ‚îÄ HIDE desktop floating header ‚îÄ‚îÄ */
            header { display: none !important; }

            /* ‚îÄ‚îÄ FIXED BOTTOM TAB BAR ‚îÄ‚îÄ */
            #mobile-tab-bar {
                display: flex !important;
                position: fixed;
                bottom: 0; left: 0; right: 0;
                z-index: 900;
                height: var(--tab-tot);
                padding-bottom: var(--tab-safe);
                background: rgba(255,255,255,0.97);
                backdrop-filter: blur(20px) saturate(180%);
                -webkit-backdrop-filter: blur(20px) saturate(180%);
                border-top: 3px solid var(--black);
                box-shadow: none;    /* cart bar border-bottom handles the join line */
                align-items: stretch;
            }

            #mobile-tab-bar .tab-item {
                flex: 1;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                gap: 3px;
                text-decoration: none;
                color: var(--black);
                font-family: 'Unbounded', sans-serif;
                font-size: 0.48rem;
                font-weight: 700;
                text-transform: uppercase;
                letter-spacing: 0.3px;
                cursor: pointer;
                background: transparent;
                border: none;
                padding: 0;
                min-height: 44px;
                position: relative;
                transition: color 0.15s ease, background 0.15s ease;
                -webkit-tap-highlight-color: transparent;
            }

            #mobile-tab-bar .tab-item .tab-icon {
                font-size: 1.3rem;
                line-height: 1;
                display: block;
                transition: transform 0.18s ease;
            }

            #mobile-tab-bar .tab-item .tab-label { display: block; line-height: 1; }

            /* Active tab: green top-bar indicator */
            #mobile-tab-bar .tab-item.active::after {
                content: '';
                position: absolute;
                top: 0; left: 20%; right: 20%;
                height: 3px;
                background: var(--accent);
            }
            #mobile-tab-bar .tab-item.active .tab-icon { transform: translateY(-2px) scale(1.12); }
            #mobile-tab-bar .tab-item:active { background: rgba(0,255,102,0.12); }

            /* Cart badge on tab */
            #mobile-tab-bar .tab-badge {
                position: absolute;
                top: 6px; right: calc(50% - 20px);
                background: var(--black); color: var(--accent);
                font-size: 0.5rem; font-weight: 900;
                min-width: 16px; height: 16px;
                border-radius: 50%;
                display: flex; align-items: center; justify-content: center;
                padding: 0 3px; line-height: 1;
            }

            /* ‚îÄ‚îÄ TOUCH INTERACTIONS (active replaces hover) ‚îÄ‚îÄ */
            .art-card:hover { transform: none; box-shadow: none; }
            .art-card:active { transform: translate(-4px,-4px); box-shadow: 6px 6px 0px var(--black); transition: transform 0.1s ease; }
            .art-card:hover .img-container img { transform: none; }

            button:hover { transform: none; box-shadow: none; }
            button:active { transform: translate(-2px,-2px); box-shadow: 3px 3px 0px var(--accent); background: var(--accent); color: var(--black); transition: transform 0.08s ease; }
            button.btn-ghost:active { background: var(--grey); color: var(--black); box-shadow: 3px 3px 0px var(--black); }
            button.btn-danger:active { background: var(--danger); color: var(--white); transform: translate(-2px,-2px); }
            button.btn-success:active { background: var(--accent); color: var(--black); }

            .folder-link:hover::after { width: 0; }
            .folder-link.active::after, .folder-link:active::after { width: 100%; }

            .sub-pill:hover { transform: none; background: transparent; color: var(--black); }
            .sub-pill:active, .sub-pill.active { background: var(--black); color: var(--white); transform: scale(1.04); }

            .qty-btn:hover { background: var(--accent); color: var(--black); transform: none; box-shadow: none; }
            .qty-btn:active { background: var(--black); color: var(--accent); transform: scale(0.9); }

            .slider-btn-nav:hover { background: rgba(255,255,255,0.9); transform: translateY(-50%); box-shadow: none; }
            .slider-btn-nav:active { background: var(--accent); transform: translateY(-50%) scale(0.9); }

            /* ‚îÄ‚îÄ 44px MINIMUM TAP TARGETS ‚îÄ‚îÄ */
            button, a, [role="button"], .folder-link, .sub-pill, .cart-btn, .btn-action { min-height: 44px; }
            input:not([type="file"]):not([type="checkbox"]), textarea, select {
                min-height: 44px;
                font-size: 16px !important; /* iOS zoom prevention */
            }
            .qty-btn { width: 44px !important; height: 44px !important; font-size: 1.3rem; }
            .slider-btn-nav { width: 44px !important; height: 44px !important; }

            /* ‚îÄ‚îÄ WELCOME BANNER ‚îÄ‚îÄ */
            #welcome-banner { padding: 24px 16px 0; }
            #welcome-banner .greet-name { font-size: clamp(1.8rem, 8vw, 2.6rem); }

            /* ‚îÄ‚îÄ CATEGORY NAV ‚îÄ‚îÄ */
            .category-section { padding: 24px 0 8px; overflow: hidden; }

            .folder-nav {
                flex-wrap: nowrap; overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                justify-content: flex-start;
                gap: 24px; padding: 4px 20px 10px;
                margin-bottom: 12px;
                scrollbar-width: none; -ms-overflow-style: none;
                -webkit-mask-image: linear-gradient(to right, black 85%, transparent 100%);
                mask-image: linear-gradient(to right, black 85%, transparent 100%);
            }
            .folder-nav::-webkit-scrollbar { display: none; }
            .folder-link { font-size: 0.8rem; flex-shrink: 0; white-space: nowrap; padding: 10px 4px; display: inline-flex; align-items: center; }

            .sub-nav {
                flex-wrap: nowrap; overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                justify-content: flex-start;
                gap: 8px; padding: 4px 20px 10px;
                min-height: unset;
                scrollbar-width: none; -ms-overflow-style: none;
            }
            .sub-nav::-webkit-scrollbar { display: none; }
            .sub-pill { flex-shrink: 0; padding: 10px 18px !important; font-size: 0.58rem; white-space: nowrap; min-height: 44px; display: inline-flex; align-items: center; }

            /* ‚îÄ‚îÄ ART GRID: 2-column ‚îÄ‚îÄ */
            .shop-container-new { padding: 16px 16px 40px; }
            .art-grid { grid-template-columns: repeat(2, 1fr); gap: 12px; }
            .card-details { flex-direction: column; align-items: flex-start; gap: 6px; margin-top: 10px; }
            .price-tag { font-size: 0.85rem; }
            .card-details .card-info h4 { font-size: 0.75rem; line-height: 1.3; }
            /* Smaller shadows ‚Äî prevent horizontal overflow */
            .art-card { box-shadow: 4px 4px 0px var(--black) !important; }

            /* ‚îÄ‚îÄ CART BAR ‚îÄ‚îÄ
               KEY FIX: bottom:0 + padding-bottom = tab bar height.
               The cart bar physically extends underneath the tab bar (z-index 900 > 400).
               There is literally no space between them ‚Äî gap is architecturally impossible. */
            .cart-bar {
                position: fixed;
                bottom: 0;
                left: 0; right: 0;
                z-index: 400;
                padding-top: 0;
                padding-left: 0;
                padding-right: 0;
                padding-bottom: var(--tab-tot);
                flex-direction: column;
                align-items: stretch;
                gap: 0;
                border-top: 3px solid var(--black);
                box-shadow: none;
                margin: 0; border-radius: 0;
                background: var(--white);
                overflow: hidden;
                transition: max-height 0.3s ease;
                max-height: calc(160px + var(--tab-tot));
            }

            /* Collapsed: toggle strip height + underlap padding */
            .cart-bar.collapsed { max-height: calc(40px + var(--tab-tot)); }

            /* Toggle strip ‚Äî always visible at top of cart bar */
            .cart-bar-toggle {
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 6px 16px;
                cursor: pointer;
                user-select: none;
                border-bottom: 1px solid var(--grey);
                min-height: 36px;
            }
            .cart-bar-toggle .toggle-summary {
                font-family: 'Unbounded', sans-serif;
                font-size: 0.52rem;
                font-weight: 900;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                display: flex; gap: 12px; align-items: center;
            }
            .cart-bar-toggle .toggle-summary b {
                background: var(--accent);
                padding: 1px 6px;
                color: var(--black);
                font-weight: 900;
            }
            .cart-bar-toggle .toggle-chevron {
                font-family: 'Unbounded', sans-serif;
                font-size: 0.65rem;
                font-weight: 900;
                line-height: 1;
                transition: transform 0.3s ease;
                color: var(--black);
            }
            .cart-bar.collapsed .toggle-chevron { transform: rotate(180deg); }

            /* Content area inside cart bar (hidden when collapsed) */
            .cart-bar-body {
                padding: 8px 16px 10px;
                display: flex;
                flex-direction: column;
                gap: 8px;
                overflow: hidden;
            }

            .cart-bar-info { gap: 12px; justify-content: center; font-size: 0.6rem; }
            .cart-bar button { width: 100%; flex-shrink: 0; padding: 12px 16px; margin: 0; min-height: 44px; }

            /* Footer: padding-bottom scrolls content clear of the fixed bars.
               40px = collapsed cart toggle strip, var(--tab-tot) = tab bar. */
            footer {
                padding-top: 32px;
                padding-left: 20px;
                padding-right: 20px;
                padding-bottom: calc(var(--tab-tot) + 40px + 8px);
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
                margin-bottom: 0;
            }
            .footer-copy { text-align: left; }
            .est-tag { font-size: 1.1rem; }

            /* ‚îÄ‚îÄ MODALS: bottom-sheet style ‚îÄ‚îÄ */
            .modal-overlay {
                padding: 0 0 0;
                align-items: flex-end;
                overflow-y: auto;
                overscroll-behavior: contain;
                -webkit-overflow-scrolling: touch;
                contain: layout style;
            }

            .modal-card, .checkout-card {
                width: 100% !important;
                max-width: 100% !important;
                min-width: 0;
                padding: 24px 18px;
                border-radius: 16px 16px 0 0 !important;
                border-bottom: none !important;
                max-height: 88vh;
                overflow-y: auto;
                overflow-x: hidden;
                -webkit-overflow-scrolling: touch;
                box-shadow: 0 -5px 0 var(--accent);
                margin: 0;
            }

            /* Drag-handle hint */
            .modal-card::before, .checkout-card::before {
                content: '';
                display: block;
                width: 36px; height: 4px;
                background: var(--grey);
                border-radius: 2px;
                margin: 0 auto 18px;
            }

            .modal-actions { flex-direction: column; gap: 10px; margin-top: 16px; }
            .modal-actions button { width: 100%; flex: none; padding: 14px 16px; min-height: 44px; }

            /* Confirm dialog buttons */
            #confirm-standard-btns { flex-direction: column; gap: 10px; }
            #confirm-standard-btns button { width: 100%; min-height: 44px; }

            /* Edit Order list */
            #edit-order-list > div { flex-wrap: nowrap; gap: 6px; padding: 12px 0; overflow: hidden; min-width: 0; }
            #edit-order-list .prod-label { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; min-width: 0; }
            #edit-order-modal .modal-card > div[style*="justify-content:space-between"] { flex-wrap: wrap; gap: 8px; }

            /* Product view */
            .slider-container { aspect-ratio: 1/1; margin-bottom: 16px; }
            .modal-price-row { padding: 12px 14px; flex-wrap: wrap; gap: 10px; }
            .modal-price { font-size: 1.1rem; }

            /* Toast: above collapsed cart bar toggle strip + tab bar */
            #custom-alert {
                bottom: calc(var(--tab-tot) + 44px);
                right: 12px; left: 12px; max-width: none;
            }
        }

        @media (max-width: 374px) {
            /* Very small phones: single column */
            .art-grid { grid-template-columns: 1fr; gap: 12px; }
            .folder-link { font-size: 0.72rem; }
        }
    </style>
</head>
<body>

<!-- ‚îÄ‚îÄ Toast ‚îÄ‚îÄ -->
<div id="custom-alert">
    <span id="alert-icon">‚ú®</span>
    <span id="alert-text">Action Successful</span>
</div>

<!-- ‚îÄ‚îÄ Confirm Dialog ‚îÄ‚îÄ -->
<div id="confirm-panel" class="modal-overlay hidden">
    <div class="modal-card narrow">
        <p id="confirm-msg" style="font-size:0.85rem; font-weight:700; margin-bottom:24px; line-height:1.5;"></p>
        <div id="confirm-standard-btns" style="display:flex; gap:10px;">
            <button id="confirm-yes" style="flex:1;">Yes</button>
            <button onclick="closeConfirm()" class="btn-ghost" style="flex:1;">No</button>
        </div>
        <div id="confirm-shipping-btns" class="hidden" style="display:flex; flex-direction:column; gap:10px;">
            <button onclick="confirmCallback('local'); closeConfirm();">üì¶ Local (PH)</button>
            <button onclick="confirmCallback('intl'); closeConfirm();" style="background:#333;">‚úàÔ∏è International</button>
            <button onclick="closeConfirm()" class="btn-ghost" style="margin-top:4px;">Cancel</button>
        </div>
    </div>
</div>

<!-- ‚îÄ‚îÄ Invoice Modal ‚îÄ‚îÄ -->
<div id="invoice-modal" class="modal-overlay hidden">
    <div class="checkout-card">
        <h2 class="serif" style="font-size:2rem; margin-bottom:4px;">Your Bag</h2>
        <p style="font-size:0.6rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:1px; margin-bottom:0;">Review before downloading</p>

        <div class="invoice-paper" id="printable-order-sheet">
            <div style="text-align:center; margin-bottom:16px;">
                <strong style="font-family:'Unbounded',sans-serif; font-size:0.75rem; letter-spacing:2px;">ORDER SHEET</strong>
                <p id="invoice-date" style="font-size:0.6rem; color:var(--text-muted); margin-top:4px;"></p>
            </div>
            <div id="invoice-items-list"></div>
            <hr class="invoice-divider">
            <div class="invoice-total">
                <span style="font-size:0.8rem;">SUBTOTAL</span>
                <span id="inv-subtotal" class="total-amount">‚Ç±0.00</span>
            </div>
            <p style="font-size:0.6rem; color:var(--text-muted); margin-top:14px; text-align:center; font-style:italic;">
                Shipping fee reflected after order form submission.
            </p>
        </div>

        <button class="btn-action btn-download" onclick="downloadOrderSheet()">1. Download Order Sheet</button>
        <button class="btn-action" onclick="proceedToCheckout()">2. Proceed to Checkout ‚Üí</button>
        <button onclick="closeModals()" style="background:none; border:none; width:100%; margin-top:14px; cursor:pointer; font-size:0.6rem; font-weight:900; text-decoration:underline; color:var(--text-muted); text-transform:uppercase; letter-spacing:1px; transform:none; box-shadow:none;">Go Back</button>
    </div>
</div>

<!-- ‚îÄ‚îÄ Edit Order Modal ‚îÄ‚îÄ -->
<div id="edit-order-modal" class="modal-overlay hidden">
    <div class="modal-card" style="max-width:480px;">
        <h2 class="serif" style="font-size:1.8rem; margin-bottom:4px;">Edit Order</h2>
        <p style="font-size:0.6rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:1px; margin-bottom:20px;">Adjust quantities or remove items</p>
        <div id="edit-order-list" style="display:flex; flex-direction:column; gap:14px;"></div>
        <div id="edit-order-empty" class="hidden" style="text-align:center; padding:40px 0; font-family:'Fraunces',serif; font-style:italic; color:var(--text-muted); font-size:1.2rem;">
            Your cart is empty.
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center; border-top: var(--border); margin-top:20px; padding-top:16px;">
            <span style="font-size:0.65rem; font-weight:900; text-transform:uppercase; letter-spacing:1px;">Running Total</span>
            <span id="edit-order-total" style="font-weight:900; font-size:1.1rem; background:var(--accent); padding:2px 12px;">‚Ç±0.00</span>
        </div>
        <div style="display:flex; gap:10px; margin-top:16px;">
            <button onclick="closeModals()" class="btn-ghost" style="flex:1;">‚Üê Back</button>
            <button onclick="closeModals(); showInvoice();" style="flex:2;">View Invoice</button>
        </div>
    </div>
</div>

<!-- ‚îÄ‚îÄ User Product View Modal ‚îÄ‚îÄ -->
<div id="user-modal" class="modal-overlay hidden">
    <div class="modal-card">
        <div class="slider-container">
            <button class="slider-btn-nav" style="left:10px;" onclick="moveSlider(-1)">‚ùÆ</button>
            <div id="slider-wrapper" class="slider-wrapper"></div>
            <button class="slider-btn-nav" style="right:10px;" onclick="moveSlider(1)">‚ùØ</button>
        </div>

        <h2 id="view-title" style="font-family:'Fraunces',serif; font-style:italic; font-size:1.6rem; margin-bottom:4px;"></h2>
        <p style="font-size:0.6rem; font-weight:700; text-transform:uppercase; letter-spacing:1.5px; color:var(--text-muted);">
            Stock available: <b id="view-stock-count" style="background:var(--accent); color:var(--black); padding:0 5px;"></b>
        </p>
        <p id="view-desc" style="font-size:0.78rem; color:var(--text-muted); line-height:1.7; margin-top:12px;"></p>

        <div class="modal-price-row">
            <span class="modal-price" id="view-price"></span>
            <div class="qty-controls">
                <button class="qty-btn" id="qty-minus">‚àí</button>
                <span id="view-qty-display">0</span>
                <button class="qty-btn" id="qty-plus">+</button>
            </div>
        </div>

        <div class="modal-actions" style="margin-top:20px;">
            <button onclick="closeModals()" class="btn-ghost" style="flex:1;">‚Üê Back</button>
            <button id="add-to-cart-btn" style="flex:2;">Add to Cart</button>
        </div>
    </div>
</div>


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     HEADER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<header>
    <a href="#" class="logo">RENCE CREATE</a>
    <div class="header-right">
        <a href="gallery.html" class="cart-btn" style="text-decoration:none;">GALLERY</a>
        <button class="cart-btn" id="header-action-btn" onclick="handleHeaderAction()">
            EDIT ORDER (<span id="cart-qty-total">0</span>)
        </button>
    </div>
</header>

<!-- ‚îÄ‚îÄ Welcome Banner ‚îÄ‚îÄ -->
<div id="welcome-banner">
    <div class="greet-line">Hello Welcome,</div>
    <div class="greet-name" id="welcome-name"></div>
</div>

<!-- ‚îÄ‚îÄ Category Nav ‚îÄ‚îÄ -->
<div class="category-section">
    <div class="folder-nav" id="folder-nav"></div>
    <div class="sub-nav"    id="sub-nav"></div>
</div>

<!-- ‚îÄ‚îÄ Art Grid ‚îÄ‚îÄ -->
<div class="shop-container-new">
    <div class="art-grid" id="shop-grid"></div>
</div>

<!-- ‚îÄ‚îÄ Sticky Cart Bar (collapsible on mobile) ‚îÄ‚îÄ -->
<div class="cart-bar" id="cart-bar">
    <!-- Toggle strip ‚Äî always visible, tapping collapses/expands -->
    <div class="cart-bar-toggle" onclick="toggleCartBar()" id="cart-bar-toggle">
        <div class="toggle-summary">
            <span>Items: <b id="cart-qty-bar">0</b></span>
            <span>‚Ç±<span id="cart-subtotal">0.00</span></span>
        </div>
        <span class="toggle-chevron">‚ñ≤</span>
    </div>
    <!-- Expandable body -->
    <div class="cart-bar-body" id="cart-bar-body">
        <button onclick="showInvoice()">VIEW INVOICE</button>
    </div>
</div>

<!-- ‚îÄ‚îÄ Footer ‚îÄ‚îÄ -->
<footer>
    <div class="est-tag">EST. 2026<br>BATANGAS. PH</div>
    <div class="footer-copy">
        DESIGNED BY RENCE CREATE<br>
        ¬© ALL RIGHTS RESERVED 2026<br>
        AUTHENTIC QUALITY
    </div>
</footer>


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     MOBILE BOTTOM TAB BAR ‚Äî hidden on desktop via CSS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<nav id="mobile-tab-bar" aria-label="Main navigation">

    <!-- Shop (active on this page) -->
    <a href="main-shop.html" class="tab-item active" aria-label="Shop">
        <span class="tab-icon">‚óà</span>
        <span class="tab-label">Shop</span>
    </a>

    <!-- Gallery -->
    <a href="gallery.html" class="tab-item" aria-label="Gallery">
        <span class="tab-icon">‚ú¶</span>
        <span class="tab-label">Gallery</span>
    </a>

    <!-- Edit Cart ‚Äî opens edit order modal, shows badge -->
    <button class="tab-item" onclick="openEditOrder()" aria-label="Edit cart">
        <span class="tab-icon" style="position:relative;display:inline-block;">
            ‚ñ£<span id="tab-cart-badge" class="tab-badge" style="display:none;">0</span>
        </span>
        <span class="tab-label">Edit Cart</span>
    </button>

    <!-- Logout -->
    <button class="tab-item" onclick="handleLogout()" aria-label="Logout">
        <span class="tab-icon">‚èª</span>
        <span class="tab-label">Logout</span>
    </button>

</nav>


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     JAVASCRIPT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<script>
    /* ‚îÄ‚îÄ‚îÄ AUTH GUARD: redirect to login if no session ‚îÄ‚îÄ‚îÄ */
    const _username = sessionStorage.getItem('rc_username');
    if (!_username) {
        window.location.href = 'index.html';
    }

    /* ‚îÄ‚îÄ‚îÄ SUPABASE ‚îÄ‚îÄ‚îÄ */
    const SUPABASE_URL = 'https://wogftjsssxfhktgdfvod.supabase.co';
    const SUPABASE_KEY = 'sb_publishable_9yJg8M-wrRXHMfuDnCtFkA_L3n1Ii36';
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    /* ‚îÄ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ */
    let categories         = { "Stickers": [], "Pins": [] };
    let catalog            = [];
    let currentCategory    = "";
    let currentSubcategory = "";
    let tempQty            = 0;
    let currentSlide       = 0;
    let hasDownloadedSheet = false;
    let confirmCallback    = null;
    const isAdmin          = localStorage.getItem('rc_is_admin') === '1';

    /* ‚îÄ‚îÄ‚îÄ SET USER NAME ‚îÄ‚îÄ‚îÄ */
    document.getElementById('welcome-name').innerText = _username || '';
    if (isAdmin) {
        document.getElementById('welcome-name').innerText = 'ADMIN';
        const btn = document.getElementById('header-action-btn');
        if (btn) btn.innerHTML = 'EDIT WEBSITE ‚ú¶';
        /* Update mobile tab label for admin */
        const tabEditLabel = document.getElementById('tab-edit-label');
        if (tabEditLabel) tabEditLabel.textContent = 'Admin';
        const tabEditIcon = document.getElementById('tab-edit-icon');
        if (tabEditIcon) tabEditIcon.textContent = '‚öô';
    }

    /* ‚îÄ‚îÄ‚îÄ DATA LOADING ‚îÄ‚îÄ‚îÄ */
    async function loadAllData() {
        const { data: setts } = await supabaseClient.from('settings').select('*').single();
        if (setts) {
            categories = (setts.category_list && !Array.isArray(setts.category_list))
                ? setts.category_list
                : { "Stickers": [], "Pins": [] };
        }
        const { data: prods } = await supabaseClient.from('products').select('*');
        if (prods) catalog = prods.map(p => ({ ...p, cartQty: 0 }));

        const firstCat = Object.keys(categories)[0] || "";
        currentCategory = firstCat;
    }

    /* ‚îÄ‚îÄ‚îÄ NOTIFICATIONS ‚îÄ‚îÄ‚îÄ */
    let _notifyTimer = null;
    function notify(text, icon = "‚ú®") {
        const box = document.getElementById('custom-alert');
        document.getElementById('alert-text').innerText = text;
        document.getElementById('alert-icon').innerText = icon;
        if (_notifyTimer) { clearTimeout(_notifyTimer); _notifyTimer = null; }
        box.classList.remove('show');
        void box.offsetWidth;
        box.classList.add('show');
        _notifyTimer = setTimeout(() => {
            box.classList.remove('show');
            _notifyTimer = null;
        }, 3000);
    }

    /* ‚îÄ‚îÄ‚îÄ CONFIRM DIALOG ‚îÄ‚îÄ‚îÄ */
    function customConfirm(msg, callback, isShipping = false) {
        document.getElementById('confirm-msg').innerText = msg;
        const std  = document.getElementById('confirm-standard-btns');
        const ship = document.getElementById('confirm-shipping-btns');
        if (isShipping) { std.classList.add('hidden'); ship.classList.remove('hidden'); }
        else            { std.classList.remove('hidden'); ship.classList.add('hidden'); }
        document.getElementById('confirm-panel').classList.remove('hidden');
        confirmCallback = callback;
    }

    function closeConfirm() { document.getElementById('confirm-panel').classList.add('hidden'); }
    document.getElementById('confirm-yes').onclick = () => { confirmCallback(); closeConfirm(); };

    /* ‚îÄ‚îÄ‚îÄ HEADER ACTION ‚îÄ‚îÄ‚îÄ */
    function handleHeaderAction() {
        if (isAdmin) {
            window.location.href = 'admin-panel.html';
        } else {
            showEditOrder();
        }
    }

    /* ‚îÄ‚îÄ‚îÄ EDIT CART (mobile tab) ‚îÄ‚îÄ‚îÄ */
    function openEditOrder() {
        showEditOrder();
    }

    /* ‚îÄ‚îÄ‚îÄ LOGOUT ‚îÄ‚îÄ‚îÄ */
    function handleLogout() {
        customConfirm("Are you sure you want to log out?", () => {
            sessionStorage.removeItem('rc_username');
            localStorage.removeItem('rc_is_admin');
            window.location.href = 'index.html';
        });
    }

    /* ‚îÄ‚îÄ‚îÄ FOLDER NAV ‚îÄ‚îÄ‚îÄ */
    function renderFolderNav() {
        const nav = document.getElementById('folder-nav');
        nav.innerHTML = '';

        Object.keys(categories).forEach(catName => {
            const span = document.createElement('span');
            span.className = `folder-link${currentCategory === catName ? ' active' : ''}`;
            span.textContent = catName;
            span.onclick = () => {
                currentCategory    = catName;
                currentSubcategory = "";
                renderFolderNav();
                renderSubNav();
                renderShop();
            };
            nav.appendChild(span);
        });

        renderSubNav();
    }

    /* ‚îÄ‚îÄ‚îÄ SUB-NAV ‚îÄ‚îÄ‚îÄ */
    function renderSubNav() {
        const nav  = document.getElementById('sub-nav');
        nav.innerHTML = '';

        const subs = categories[currentCategory] || [];
        if (subs.length === 0) { nav.style.display = 'none'; return; }
        nav.style.display = 'flex';

        const allBtn = document.createElement('button');
        allBtn.className = `sub-pill${currentSubcategory === '' ? ' active' : ''}`;
        allBtn.textContent = 'All';
        allBtn.onclick = () => { currentSubcategory = ""; renderSubNav(); renderShop(); };
        nav.appendChild(allBtn);

        subs.forEach(s => {
            const btn = document.createElement('button');
            btn.className = `sub-pill${currentSubcategory === s ? ' active' : ''}`;
            btn.textContent = s;
            btn.onclick = () => {
                currentSubcategory = (currentSubcategory === s) ? "" : s;
                renderSubNav();
                renderShop();
            };
            nav.appendChild(btn);
        });
    }

    /* ‚îÄ‚îÄ‚îÄ RENDER SHOP ‚îÄ‚îÄ‚îÄ */
    function renderShop() {
        const grid = document.getElementById('shop-grid');
        grid.innerHTML = '';

        const filtered = catalog.filter(item => {
            const matchCat = item.category === currentCategory;
            const matchSub = !currentSubcategory || item.subcategory === currentSubcategory;
            return matchCat && matchSub && item.status === 'live';
        });

        if (filtered.length === 0) {
            grid.innerHTML = `
                <div class="empty-state">
                    <h2>Work In Progress</h2>
                    <p>Check back soon for new drops.</p>
                </div>`;
            return;
        }

        filtered.forEach(item => {
            const idx = catalog.indexOf(item);
            const iconSrc = item.product_icon || item.display_images?.[0] || null;
            const imgHTML = iconSrc
                ? `<img src="${iconSrc}" alt="${item.name}" style="width:100%;height:100%;object-fit:cover;display:block;">`
                : `<div class="img-placeholder">No Image</div>`;
            const subLabel = item.subcategory || item.category || '';

            const card = document.createElement('div');
            card.className = 'art-card';
            card.onclick   = () => openUserView(idx);
            card.innerHTML = `
                <div class="img-container" style="aspect-ratio:1/1;">${imgHTML}</div>
                <div class="card-details">
                    <div class="card-info">
                        <small>${subLabel.toUpperCase()}</small>
                        <h4>${item.name}</h4>
                    </div>
                    <span class="price-tag">‚Ç±${item.price.toFixed(2)}</span>
                </div>`;
            grid.appendChild(card);
        });
    }

    /* ‚îÄ‚îÄ‚îÄ CART TOTALS ‚îÄ‚îÄ‚îÄ */
    function updateCartTotals() {
        let count = 0, sub = 0;
        catalog.forEach(item => {
            if (item.cartQty > 0) { count += item.cartQty; sub += item.cartQty * item.price; }
        });
        const hc = document.getElementById('cart-qty-total');
        if (hc) hc.innerText = count;
        const bc = document.getElementById('cart-qty-bar');
        if (bc) bc.innerText = count;
        const bs = document.getElementById('cart-subtotal');
        if (bs) bs.innerText = sub.toFixed(2);

        /* ‚îÄ‚îÄ Sync mobile tab bar cart badge ‚îÄ‚îÄ */
        const badge = document.getElementById('tab-cart-badge');
        if (badge) {
            badge.textContent  = count;
            badge.style.display = count > 0 ? 'flex' : 'none';
        }
    }

    /* ‚îÄ‚îÄ‚îÄ EDIT ORDER MODAL ‚îÄ‚îÄ‚îÄ */
    function showEditOrder() {
        renderEditOrder();
        document.getElementById('edit-order-modal').classList.remove('hidden');
    }

    function renderEditOrder() {
        const list      = document.getElementById('edit-order-list');
        const emptyMsg  = document.getElementById('edit-order-empty');
        const totalEl   = document.getElementById('edit-order-total');
        list.innerHTML  = '';

        const cartItems = catalog.filter(item => item.cartQty > 0);

        if (cartItems.length === 0) {
            emptyMsg.classList.remove('hidden');
            totalEl.innerText = '‚Ç±0.00';
            return;
        }
        emptyMsg.classList.add('hidden');

        let runningTotal = 0;

        cartItems.forEach(item => {
            const idx       = catalog.indexOf(item);
            const lineTotal = item.cartQty * item.price;
            runningTotal   += lineTotal;

            const thumbSrc  = item.product_icon || item.display_images?.[0] || '';
            const thumbHTML = thumbSrc
                ? `<img src="${thumbSrc}" style="width:56px;height:56px;object-fit:cover;border:2px solid var(--black);flex-shrink:0;" alt="${item.name}">`
                : `<div style="width:56px;height:56px;background:var(--bg);border:2px solid var(--black);display:flex;align-items:center;justify-content:center;font-size:0.5rem;color:var(--text-muted);flex-shrink:0;">IMG</div>`;

            const row = document.createElement('div');
            row.id = `edit-row-${idx}`;
            row.style.cssText = 'display:flex;align-items:center;gap:12px;padding:10px 0;border-bottom:1px solid var(--grey);';
            row.innerHTML = `
                ${thumbHTML}
                <div style="flex:1;min-width:0;">
                    <div style="font-weight:900;font-size:0.75rem;text-transform:uppercase;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${item.name}</div>
                    <div style="font-size:0.6rem;color:var(--text-muted);margin-top:2px;">‚Ç±${item.price.toFixed(2)} each</div>
                </div>
                <div style="display:flex;align-items:center;gap:8px;">
                    <button class="qty-btn" style="width:36px;height:36px;font-size:0.9rem;" onclick="editOrderQty(${idx}, -1)">‚àí</button>
                    <span style="font-weight:900;font-size:0.85rem;min-width:20px;text-align:center;">${item.cartQty}</span>
                    <button class="qty-btn" style="width:36px;height:36px;font-size:0.9rem;" onclick="editOrderQty(${idx}, 1)">+</button>
                </div>
                <span style="font-weight:900;font-size:0.85rem;background:var(--accent);padding:2px 8px;white-space:nowrap;">‚Ç±${lineTotal.toFixed(2)}</span>
                <button onclick="editOrderRemove(${idx})" style="background:none;border:none;color:var(--danger);font-size:1.1rem;font-weight:900;padding:0 4px;box-shadow:none;transform:none;min-width:unset;cursor:pointer;" title="Remove">√ó</button>`;
            list.appendChild(row);
        });

        totalEl.innerText = `‚Ç±${runningTotal.toFixed(2)}`;
    }

    function editOrderQty(idx, delta) {
        const item   = catalog[idx];
        const newQty = (item.cartQty || 0) + delta;
        if (newQty < 0) return;
        if (newQty > item.stock) { notify("Reached maximum stock", "‚ö†Ô∏è"); return; }
        item.cartQty = newQty;
        updateCartTotals();
        renderEditOrder();
    }

    function editOrderRemove(idx) {
        catalog[idx].cartQty = 0;
        updateCartTotals();
        renderEditOrder();
        notify("Item removed", "üóëÔ∏è");
    }

    /* ‚îÄ‚îÄ‚îÄ INVOICE / CHECKOUT ‚îÄ‚îÄ‚îÄ */
    function showInvoice() {
        hasDownloadedSheet = false;
        const listCon = document.getElementById('invoice-items-list');
        listCon.innerHTML = '';
        let subtotal = 0, hasItems = false;

        document.getElementById('invoice-date').innerText = new Date().toLocaleString();

        catalog.forEach(item => {
            if (item.cartQty > 0) {
                hasItems = true;
                const itemTotal = item.cartQty * item.price;
                subtotal += itemTotal;
                listCon.innerHTML += `
                    <div class="invoice-row">
                        <div>
                            <div class="item-name">${item.name}</div>
                            <div class="item-qty">‚Ç±${item.price.toFixed(2)} √ó ${item.cartQty}</div>
                        </div>
                        <div class="item-price">‚Ç±${itemTotal.toFixed(2)}</div>
                    </div>`;
            }
        });

        if (!hasItems) { notify("Your cart is empty!", "üõí"); return; }

        document.getElementById('inv-subtotal').innerText = `‚Ç±${subtotal.toFixed(2)}`;
        document.getElementById('invoice-modal').classList.remove('hidden');
    }

    function downloadOrderSheet() {
        const sheet = document.getElementById('printable-order-sheet');
        html2canvas(sheet).then(canvas => {
            const link    = document.createElement('a');
            link.download = `order-${Date.now()}.png`;
            link.href     = canvas.toDataURL();
            link.click();
            hasDownloadedSheet = true;
            notify("Order Sheet Saved!", "üìÑ");
        });
    }

    function proceedToCheckout() {
        if (!hasDownloadedSheet) { notify("Please download the order sheet first.", "‚ö†Ô∏è"); return; }
        customConfirm("Where are you ordering from?", choice => {
            const localURL = "https://docs.google.com/forms/d/e/1FAIpQLSdLMu09mL10Gh6BGKQaY3Oa0iJnw2esAbpeVw_d7nrrhnZu2Q/viewform?usp=sharing&ouid=101835408618855772238";
            const intlURL  = "https://docs.google.com/forms/d/e/1FAIpQLSfQ4-Po8E5xW_XyYnB9yFE53qYucCIGBmwzHZTpyKBOVWFHkA/viewform?usp=sharing&ouid=101835408618855772238";
            window.open(choice === 'local' ? localURL : intlURL, '_blank');
        }, true);
    }

    function closeModals() {
        document.querySelectorAll('.modal-overlay').forEach(m => m.classList.add('hidden'));
    }

    /* ‚îÄ‚îÄ‚îÄ PRODUCT VIEW MODAL ‚îÄ‚îÄ‚îÄ */
    function openUserView(idx) {
        const item = catalog[idx];
        tempQty = 0; currentSlide = 0;

        document.getElementById('view-title').innerText       = item.name;
        document.getElementById('view-desc').innerText        = item.description || "";
        document.getElementById('view-price').innerText       = `‚Ç±${item.price.toFixed(2)}`;
        document.getElementById('view-stock-count').innerText = item.stock;

        const wrap    = document.getElementById('slider-wrapper');
        wrap.innerHTML = '';
        const slides  = item.display_images?.length ? item.display_images
                      : item.product_icon ? [item.product_icon]
                      : [];

        if (slides.length > 0) {
            slides.forEach(src => {
                wrap.innerHTML += `<img src="${src}" alt="${item.name}" style="width:100%;height:100%;object-fit:cover;flex-shrink:0;">`;
            });
        } else {
            wrap.innerHTML = `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:0.7rem;color:var(--text-muted);font-weight:700;text-transform:uppercase;letter-spacing:2px;background:var(--bg);">No Preview Available</div>`;
        }
        wrap.style.transform = 'translateX(0)';

        document.getElementById('qty-plus').onclick = () => {
            if (tempQty < item.stock) { tempQty++; updateQtyDisplay(item); }
            else notify("Reached maximum stock", "‚ö†Ô∏è");
        };
        document.getElementById('qty-minus').onclick = () => {
            if (tempQty > 0) { tempQty--; updateQtyDisplay(item); }
        };
        document.getElementById('add-to-cart-btn').onclick = () => {
            if (tempQty > 0) {
                item.cartQty = (item.cartQty || 0) + tempQty;
                updateCartTotals();
                notify("Added to cart!", "üõí");
                closeModals();
            } else notify("Please select a quantity", "‚òùÔ∏è");
        };

        updateQtyDisplay(item);
        document.getElementById('user-modal').classList.remove('hidden');
    }

    function updateQtyDisplay(item) {
        const display  = document.getElementById('view-qty-display');
        const plusBtn  = document.getElementById('qty-plus');
        const minusBtn = document.getElementById('qty-minus');
        if (display)  display.innerText  = tempQty;
        if (minusBtn) minusBtn.style.opacity = tempQty <= 0          ? "0.3" : "1";
        if (plusBtn)  plusBtn.style.opacity  = tempQty >= item.stock ? "0.3" : "1";
    }

    function moveSlider(dir) {
        const wrap = document.getElementById('slider-wrapper');
        const imgs = wrap.querySelectorAll('img');
        if (!imgs.length) return;
        currentSlide = (currentSlide + dir + imgs.length) % imgs.length;
        wrap.style.transform = `translateX(-${currentSlide * 100}%)`;
    }

    /* ‚îÄ‚îÄ‚îÄ KEYBOARD: ESC closes modals ‚îÄ‚îÄ‚îÄ */
    document.addEventListener('keydown', e => {
        if (e.key === 'Escape') closeModals();
    });

    /* ‚îÄ‚îÄ‚îÄ CART BAR COLLAPSE (mobile) ‚îÄ‚îÄ‚îÄ */
    function toggleCartBar() {
        const bar = document.getElementById('cart-bar');
        if (bar) bar.classList.toggle('collapsed');
    }

    /* ‚îÄ‚îÄ‚îÄ HEADROOM: hide header on scroll-down (desktop only) ‚îÄ‚îÄ‚îÄ */
    (function initHeadroom() {
        if (window.innerWidth < 768) return; /* tab bar handles nav on mobile */
        const hdr = document.querySelector('header');
        if (!hdr) return;
        let lastScrollY = window.scrollY;
        let ticking     = false;
        const THRESHOLD = 60;

        function onScroll() {
            if (!ticking) {
                window.requestAnimationFrame(() => {
                    const currentY  = window.scrollY;
                    const scrolled  = currentY > THRESHOLD;
                    const goingDown = currentY > lastScrollY;
                    if (scrolled && goingDown) {
                        hdr.classList.add('headroom--hidden');
                    } else {
                        hdr.classList.remove('headroom--hidden');
                    }
                    lastScrollY = currentY <= 0 ? 0 : currentY;
                    ticking = false;
                });
                ticking = true;
            }
        }
        window.addEventListener('scroll', onScroll, { passive: true });
    })();

    /* ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ */
    (async function init() {
        await loadAllData();
        renderFolderNav();
        renderShop();
        updateCartTotals();
    })();
</script>
</body>
</html>
